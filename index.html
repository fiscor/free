<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FISCOR | Version Gratuite</title>
    <meta name="description" content="Interface Strat√©gique Fiscale - Version D√©couverte">
    <meta name="theme-color" content="#F8FAFC">
    
    <!-- Police Inter (Google Fonts) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        /* --- RESET & VARIABLES (LIGHT THEME) --- */
        :root {
            --bg-main: #F8FAFC;       /* Fond principal : Blanc cass√© tr√®s l√©ger */
            --bg-card: #FFFFFF;       /* Cartes : Blanc pur */
            --bg-card-hover: #F1F5F9; /* Hover : Gris tr√®s l√©ger */
            --text-main: #0F172A;     /* Texte : Noir Encre (Slate 900) */
            --text-secondary: #64748B;/* Secondaire : Gris Moyen (Slate 500) */
            --border: #E2E8F0;        /* Bordures : Gris clair (Slate 200) */
            --border-highlight: #94A3B8; /* Bordures focus : Gris moyen */
            --accent: #14532D;        /* Vert profond FISCOR */
            --accent-glow: #15803D;   /* Vert pour focus/√©tats actifs */
            --accent-pro: #7C3AED;    /* Violet PRO (Demand√©) */
            --accent-pro-dark: #5B21B6;
            --danger: #DC2626;
            --locked: #94A3B8;        /* Couleur √©l√©ments verrouill√©s */
            --transition-fast: 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            --transition-smooth: 0.4s cubic-bezier(0.16, 1, 0.3, 1);
            --shadow-card: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
            --glass: rgba(248, 250, 252, 0.9);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: var(--bg-main);
            color: var(--text-main);
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* --- UTILS --- */
        .hidden { display: none !important; }
        .fade-in { animation: fadeIn 0.4s var(--transition-smooth) forwards; }
        .slide-up { animation: slideUp 0.6s var(--transition-smooth) forwards; }
        
        /* Utility classes for locking */
        .is-locked { 
            opacity: 0.6; 
            pointer-events: none; 
            filter: grayscale(0.8); 
            position: relative;
        }
        
        .nav-locked {
            opacity: 0.5;
            cursor: not-allowed !important;
        }
        
        .lock-icon-overlay {
            position: absolute;
            top: 10px;
            right: 10px;
            color: var(--text-secondary);
            z-index: 10;
        }

        .premium-badge {
            display: inline-block;
            background: #000;
            color: #fff;
            font-size: 0.6rem;
            padding: 2px 6px;
            border-radius: 4px;
            margin-left: 8px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* --- LOCK SCREEN (ENTRY) --- */
        #view-lock {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle at center, #FFFFFF 0%, #F1F5F9 80%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 1;
            transition: opacity 0.5s ease;
        }
        #view-lock.fade-out {
            opacity: 0;
            pointer-events: none;
        }

        .lock-container {
            text-align: center;
            width: 100%;
            max-width: 320px;
            padding: 20px;
        }

        .brand-logo {
            font-size: 2rem;
            font-weight: 700;
            letter-spacing: 2px;
            margin-bottom: 0.5rem;
            color: var(--text-main);
        }

        .brand-sub {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 3px;
            color: var(--text-secondary);
            margin-bottom: 3rem;
            opacity: 0.7;
        }

        .btn-access {
            background: var(--text-main); /* Noir pour l'entr√©e */
            border: 1px solid var(--text-main);
            color: #fff;
            padding: 14px 30px;
            border-radius: 6px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all var(--transition-fast);
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 600;
            box-shadow: var(--shadow-card);
            width: 100%;
        }

        .btn-access:hover {
            background: #333;
            transform: translateY(-2px);
        }
        
        .free-notice {
            margin-top: 20px;
            font-size: 0.75rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        /* --- LOADING SCREEN --- */
        #view-loading {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-main);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 900;
        }

        .loader-ring {
            width: 50px;
            height: 50px;
            border: 2px solid rgba(0,0,0,0.05);
            border-top: 2px solid var(--accent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        .loader-text {
            color: var(--text-secondary);
            font-size: 0.9rem;
            letter-spacing: 1px;
            animation: pulse 2s infinite;
        }

        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        @keyframes pulse { 0%, 100% { opacity: 0.5; } 50% { opacity: 1; } }

        /* --- APP LAYOUT --- */
        #view-app {
            display: flex;
            height: 100vh;
            width: 100vw;
            opacity: 0;
            transition: opacity 0.8s ease;
        }

        #view-app.visible { opacity: 1; }

        .sidebar {
            width: 260px;
            background: var(--bg-main);
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            padding: 24px 0;
            flex-shrink: 0;
            z-index: 50;
        }

        .sidebar-header { padding: 0 24px 30px; }
        .sidebar-nav { flex: 1; display: flex; flex-direction: column; gap: 4px; padding: 0 12px; }

        .nav-item {
            display: flex; align-items: center; padding: 12px 16px; border-radius: 8px;
            color: var(--text-secondary); text-decoration: none; font-size: 0.95rem;
            transition: all var(--transition-fast); cursor: pointer; position: relative;
        }
        .nav-item:hover:not(.nav-locked) { background: rgba(0, 0, 0, 0.04); color: var(--text-main); }
        .nav-item.active { background: rgba(20, 83, 45, 0.08); color: var(--text-main); font-weight: 600; }
        .nav-item.active::before {
            content: ''; position: absolute; left: 0; top: 50%; transform: translateY(-50%);
            height: 16px; width: 3px; background-color: var(--accent); border-radius: 0 2px 2px 0;
        }
        .nav-item.nav-locked svg { opacity: 0.5; }

        .main-content {
            flex: 1; position: relative; overflow-y: auto; background: var(--bg-main); scroll-behavior: smooth;
        }

        .top-bar {
            position: sticky; top: 0; display: flex; justify-content: space-between; align-items: center;
            padding: 20px 30px; background: var(--glass); backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px); border-bottom: 1px solid var(--border); z-index: 40;
        }

        .page-title-group h1 { font-size: 1.1rem; font-weight: 700; color: var(--text-main); }
        .page-title-group span { font-size: 0.8rem; color: var(--text-secondary); }

        .btn-logout {
            background: transparent; border: 1px solid var(--border); color: var(--text-secondary);
            padding: 6px 14px; border-radius: 20px; font-size: 0.75rem; cursor: pointer;
            transition: all var(--transition-fast); display: flex; align-items: center; gap: 6px;
        }
        .btn-logout:hover { border-color: var(--text-secondary); color: var(--text-main); background: #fff; }

        .content-container { padding: 40px 30px 100px 30px; max-width: 1200px; margin: 0 auto; }

        .hero-section { margin-bottom: 40px; }
        .hero-title {
            font-size: 2.5rem; font-weight: 800; margin-bottom: 10px; letter-spacing: -0.8px;
            background: linear-gradient(180deg, #0F172A 0%, #475569 100%);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .hero-desc { color: var(--text-secondary); font-size: 1.1rem; max-width: 600px; line-height: 1.6; }
        
        .badge-status {
            display: inline-flex; align-items: center; gap: 6px; padding: 4px 10px;
            background: #F1F5F9; border: 1px solid var(--border); border-radius: 4px;
            font-size: 0.75rem; color: var(--text-main); margin-top: 16px;
            text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600;
        }
        .dot { width: 6px; height: 6px; background: var(--accent-glow); border-radius: 50%; display: inline-block; }
        .dot.free { background: #94A3B8; }
        .dot.red { background: var(--danger); }
        .dot.purple { background: var(--accent-pro); box-shadow: 0 0 10px rgba(124, 58, 237, 0.4); }

        /* GRID CARDS & GENERIC */
        .cards-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; }
        .card {
            background: var(--bg-card); border: 1px solid var(--border); border-radius: 12px;
            padding: 24px; cursor: pointer; transition: all var(--transition-fast);
            position: relative; overflow: hidden; display: flex; flex-direction: column;
            justify-content: space-between; min-height: 140px; box-shadow: var(--shadow-card);
        }
        .card:not(.is-locked):hover { transform: translateY(-4px); border-color: var(--border-highlight); background: var(--bg-card-hover); }
        .card-title { font-size: 1.1rem; font-weight: 600; color: var(--text-main); margin-bottom: 8px; }
        .card-icon { align-self: flex-start; margin-bottom: 16px; color: var(--text-secondary); opacity: 0.7; }
        .card:not(.is-locked):hover .card-icon { color: var(--accent); opacity: 1; }
        .card-arrow {
            position: absolute; bottom: 24px; right: 24px; opacity: 0; transform: translateX(-10px);
            transition: all var(--transition-fast); color: var(--text-secondary);
        }
        .card:not(.is-locked):hover .card-arrow { opacity: 1; transform: translateX(0); }

        /* Highlight for the active free tool */
        .card.active-tool {
            border: 1px solid var(--accent);
            background: #F0FDF4;
        }
        .card.active-tool .card-icon { color: var(--accent); opacity: 1; }
        .card.active-tool .card-arrow { opacity: 1; transform: translateX(0); }

        /* --- DASHBOARD WIDGETS (NEW HOME) --- */
        .pro-hero {
            position: relative;
            padding: 30px;
            background: linear-gradient(135deg, #F8FAFC 0%, #F3E8FF 100%);
            border: 1px solid #E9D5FF;
            border-radius: 12px;
            margin-bottom: 40px;
        }
        
        .pro-badge {
            background: var(--accent-pro); color: #fff; display: inline-block;
            font-size: 0.65rem; font-weight: 700; text-transform: uppercase;
            padding: 4px 10px; border-radius: 20px; margin-bottom: 12px; letter-spacing: 1px;
        }
        
        .pro-actions { display: flex; gap: 15px; margin-top: 25px; flex-wrap: wrap; }
        
        .btn-pro {
            background: var(--accent-pro); color: #fff; text-decoration: none;
            padding: 12px 24px; border-radius: 6px; font-weight: 600; font-size: 0.9rem;
            transition: all 0.2s; border: none; box-shadow: 0 4px 12px rgba(124, 58, 237, 0.25);
        }
        .btn-pro:hover { background: var(--accent-pro-dark); transform: translateY(-2px); }
        
        .btn-outline {
            background: transparent; color: var(--text-main); text-decoration: none;
            padding: 11px 23px; border-radius: 6px; font-weight: 600; font-size: 0.9rem;
            transition: all 0.2s; border: 1px solid var(--border-highlight);
        }
        .btn-outline:hover { border-color: var(--text-main); background: #fff; }

        /* Widget: Chart Bars */
        .stat-card { justify-content: flex-start; min-height: 220px; }
        .stat-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .stat-label { font-size: 0.75rem; color: var(--text-secondary); font-weight: 600; letter-spacing: 1px; text-transform: uppercase; }
        
        .tax-row { display: flex; align-items: center; margin-bottom: 12px; font-size: 0.9rem; }
        .tax-country { width: 80px; font-weight: 500; }
        .tax-track { flex: 1; height: 24px; background: #F1F5F9; border-radius: 4px; overflow: hidden; position: relative; margin: 0 10px; }
        .tax-bar { height: 100%; border-radius: 4px; display: flex; align-items: center; padding-left: 8px; font-size: 0.75rem; color: #fff; font-weight: 600; width: 0; animation: growBar 1.5s ease-out forwards; }
        .tax-val { width: 40px; text-align: right; font-weight: 700; font-size: 0.9rem; }
        
        .bar-red { background: var(--danger); }
        .bar-green { background: var(--accent); }
        .bar-violet { background: var(--accent-pro); }
        
        @keyframes growBar { from { width: 0; } to { width: var(--w); } }

        /* Widget: Risks */
        .risk-item { margin-bottom: 15px; }
        .risk-head { display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 0.85rem; font-weight: 500; }
        .risk-bar-bg { height: 6px; background: #E2E8F0; border-radius: 3px; overflow: hidden; }
        .risk-bar-fill { height: 100%; background: #000; border-radius: 3px; }

        /* Widget: Book */
        .book-widget {
            background: #1e1e1e; color: #fff; border: 1px solid #333;
            display: flex; flex-direction: row; align-items: center;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        /* FIX: FORCE DARK BACKGROUND ON HOVER FOR BOOK WIDGET */
        .book-widget:hover {
            background: #111 !important; /* Keep it dark */
            border-color: var(--text-main) !important;
            transform: translateY(-4px);
        }
        .book-info { flex: 1; z-index: 2; }
        .book-visual { 
            width: 60px; height: 80px; background: #fff; margin-left: 15px; 
            box-shadow: -2px 2px 10px rgba(255,255,255,0.1); border-radius: 2px;
            position: relative;
        }
        .book-visual::before { content:''; position:absolute; left:4px; top:0; bottom:0; width:1px; background:#ddd; }

        /* Widget: Calendar */
        .cal-item { display: flex; gap: 12px; padding: 10px 0; border-bottom: 1px solid var(--bg-card-hover); }
        .cal-item:last-child { border-bottom: none; }
        .cal-date { 
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            background: #F8FAFC; border: 1px solid var(--border); border-radius: 8px; width: 45px; height: 45px;
            font-size: 0.75rem; color: var(--text-secondary); font-weight: 700;
        }
        .cal-date span { font-size: 1rem; color: var(--text-main); }
        .cal-info { flex: 1; display: flex; flex-direction: column; justify-content: center; }
        .cal-title { font-size: 0.9rem; font-weight: 600; color: var(--text-main); }
        .cal-sub { font-size: 0.75rem; color: var(--text-secondary); }

        /* --- POPUP MARKETING --- */
        #popup-promo {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); backdrop-filter: blur(5px);
            z-index: 2000; display: flex; justify-content: center; align-items: center;
            opacity: 0; pointer-events: none; transition: opacity 0.3s;
        }
        #popup-promo.active { opacity: 1; pointer-events: all; }
        
        .popup-content {
            background: #fff; width: 90%; max-width: 450px; padding: 40px;
            border-radius: 16px; text-align: center; position: relative;
            transform: scale(0.9); transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        #popup-promo.active .popup-content { transform: scale(1); }
        
        .popup-close {
            position: absolute; top: 15px; right: 15px; background: none; border: none;
            font-size: 1.5rem; cursor: pointer; color: var(--text-secondary);
        }
        .popup-icon {
            width: 60px; height: 60px; background: #F3E8FF; border-radius: 50%;
            color: var(--accent-pro); display: flex; justify-content: center; align-items: center;
            margin: 0 auto 20px auto;
        }

        /* --- FORMATION SPECIFIC STYLES --- */
        .f-meta { font-size: 0.8rem; color: var(--text-secondary); margin-bottom: 12px; display: flex; gap: 10px; align-items: center;}
        .f-tag-pill {
            background: #F1F5F9; color: #475569; padding: 4px 10px; border-radius: 20px;
            font-size: 0.75rem; font-weight: 500;
        }
        .f-duration { display: flex; align-items: center; gap: 4px; }
        
        .search-container { margin-bottom: 30px; display: flex; gap: 10px; flex-wrap: wrap; }
        .search-input {
            flex: 1; min-width: 250px; background: var(--bg-card); border: 1px solid var(--border);
            padding: 14px 20px; border-radius: 10px; color: var(--text-main); font-size: 1rem;
            box-shadow: var(--shadow-card); padding-left: 48px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='%2364748B' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='11' cy='11' r='8'%3E%3C/circle%3E%3Cline x1='21' y1='21' x2='16.65' y2='16.65'%3E%3C/line%3E%3C/svg%3E");
            background-repeat: no-repeat; background-position: 16px center;
        }
        .filter-tag {
            border: 1px solid var(--border); background: var(--bg-card); color: var(--text-secondary);
            padding: 0 16px; border-radius: 20px; height: 48px; cursor: pointer; transition: all 0.2s; font-size: 0.9rem;
        }
        .filter-tag:hover, .filter-tag.active { border-color: var(--accent); color: var(--accent); background: #F0FDF4; }

        .bottom-nav {
            display: none; position: fixed; bottom: 0; left: 0; width: 100%;
            background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
            border-top: 1px solid var(--border); padding: 10px 20px; justify-content: space-between; z-index: 100;
        }
        .b-nav-item {
            display: flex; flex-direction: column; align-items: center; gap: 4px; color: #94A3B8;
            text-decoration: none; font-size: 0.65rem; background: none; border: none; cursor: pointer; transition: color 0.3s;
        }
        .b-nav-item svg { width: 22px; height: 22px; stroke: currentColor; }
        .b-nav-item.active { color: var(--accent); font-weight: 600; }
        .b-nav-item.active svg { stroke: var(--accent); }
        .b-nav-item.nav-locked { opacity: 0.4; }

        @media (max-width: 768px) {
            .sidebar { display: none; }
            .bottom-nav { display: flex; }
            .content-container { padding: 20px 20px 100px 20px; }
            .top-bar { padding: 15px 20px; }
            .hero-title { font-size: 1.8rem; }
            .cards-grid { grid-template-columns: 1fr; }
            .btn-logout span { display: none; }
            .pro-actions { width: 100%; flex-direction: column; gap: 10px; }
            .btn-pro, .btn-outline { width: 100%; text-align: center; }
        }
    </style>
<link rel="stylesheet" href="/index.css">
</head>
<body>

    <!-- 1. LOCK SCREEN (FREE ACCESS) -->
    <div id="view-lock">
        <div class="lock-container slide-up">
            <div class="brand-logo">FISCOR</div>
            <div class="brand-sub">BOUCLIER FISCAL</div>
            
            <button id="btn-login" class="btn-access">Acc√©der √† l'interface</button>
            <div class="free-notice">Version D√©couverte - Acc√®s Limit√©</div>
        </div>
    </div>

    <!-- 2. LOADING SCREEN -->
    <div id="view-loading" class="hidden">
        <div class="loader-ring"></div>
        <div class="loader-text">INITIALISATION MODE GRATUIT...</div>
    </div>

    <!-- 3. APP VIEW -->
    <div id="view-app" class="hidden">
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="brand-logo" style="font-size: 1.5rem;">FISCOR</div>
                <div class="brand-sub" style="margin-bottom:0;">VERSION GRATUITE</div>
            </div>
            <nav class="sidebar-nav" id="desktop-nav"></nav>
        </aside>

        <main class="main-content">
            <header class="top-bar">
                <div class="page-title-group">
                    <h1 id="header-title">Accueil</h1>
                    <span id="header-date">Session Invit√©</span>
                </div>
                <button class="btn-logout" id="btn-logout">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>
                    <span>Quitter</span>
                </button>
            </header>
            <div id="content-area" class="content-container"></div>
        </main>

        <nav class="bottom-nav" id="mobile-nav"></nav>
    </div>

    <!-- 4. POPUP MARKETING (PRO) -->
    <div id="popup-promo">
        <div class="popup-content">
            <button class="popup-close" onclick="closePopup()">√ó</button>
            <div class="popup-icon">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path></svg>
            </div>
            <h2 style="font-size:1.5rem; margin-bottom:10px; color:var(--text-main);">Passez au niveau sup√©rieur</h2>
            <p style="color:var(--text-secondary); margin-bottom:30px; line-height:1.6;">
                Vous naviguez depuis 5 minutes. Les vraies strat√©gies (Montages soci√©t√©s, Expatriation, Optimisation TVA) sont r√©serv√©es aux membres PRO.
            </p>
            <a href="https://fiscor.fr" target="_blank" class="btn-pro" style="display:block; width:100%;">D√©bloquer FISCOR PRO</a>
        </div>
    </div>

    <script>
        // --- DATA LAYER (Simplified for Free Version) ---
        // Content stripped but titles kept for "Locked Showcase"
        const FORMATIONS_DB = [
            { id: 1, title: "B√©n√©fice ‚â† Cash", duration: "5 min", tags: ["Bases", "Gestion"] },
            { id: 2, title: "Les 3 caisses", duration: "6 min", tags: ["Bases", "Strat√©gie"] },
            { id: 3, title: "TVA : Franchise en base", duration: "4 min", tags: ["TVA", "Micro"] },
            { id: 4, title: "TVA UE B2B Autoliquidation", duration: "7 min", tags: ["TVA", "International"] },
            { id: 5, title: "Micro vs R√©el", duration: "5 min", tags: ["Statuts", "Strat√©gie"] },
            { id: 6, title: "SASU vs EURL", duration: "8 min", tags: ["Statuts", "Juridique"] },
            { id: 7, title: "Salaire vs Dividendes", duration: "6 min", tags: ["R√©mun√©ration", "Optimisation"] },
            { id: 8, title: "Mentions facture", duration: "4 min", tags: ["Facturation", "Juridique"] },
            { id: 9, title: "Salariat D√©guis√©", duration: "7 min", tags: ["URSSAF", "Risque"] },
            { id: 10, title: "R√©sidence Fiscale", duration: "9 min", tags: ["Expat", "International"] },
            { id: 11, title: "D√©marrer propre", duration: "6 min", tags: ["D√©marrage", "Fondations"] },
            { id: 12, title: "Choisir Activit√©", duration: "7 min", tags: ["D√©marrage", "Statuts"] },
            { id: 13, title: "Micro : Constraints", duration: "5 min", tags: ["Micro", "Strat√©gie"] },
            { id: 14, title: "Seuils Micro 2024", duration: "5 min", tags: ["Micro", "Chiffres"] },
            { id: 15, title: "Facturer Propre", duration: "6 min", tags: ["Facturation", "D√©marrage"] },
            { id: 16, title: "Preuves J1", duration: "6 min", tags: ["Contr√¥le", "Fondations"] },
            { id: 17, title: "Trop d'imp√¥ts ?", duration: "7 min", tags: ["Bases", "Mindset"] },
            { id: 18, title: "CA / Marge / B√©n√©fice", duration: "6 min", tags: ["Bases", "Gestion"] },
            { id: 19, title: "Tr√©sorerie (Survivre)", duration: "8 min", tags: ["Bases", "Gestion"] },
            { id: 20, title: "Facturer la TVA", duration: "8 min", tags: ["TVA", "Facturation"] },
            { id: 21, title: "TVA collect√©e vs d√©ductible", duration: "5 min", tags: ["TVA", "Bases"] },
            { id: 22, title: "UE B2B : Autoliquidation", duration: "7 min", tags: ["TVA", "International"] },
            { id: 23, title: "UE B2C : R√®gles simples", duration: "6 min", tags: ["TVA", "International"] },
            { id: 24, title: "Hors UE : R√®gles simples", duration: "6 min", tags: ["TVA", "International"] },
            { id: 25, title: "Presta Num√©riques : Pi√®ges", duration: "7 min", tags: ["TVA", "Digital"] },
            { id: 26, title: "Acompte / Avoir / Solde", duration: "8 min", tags: ["TVA", "Facturation"] },
            { id: 27, title: "Mentions sc√©narios", duration: "6 min", tags: ["TVA", "Facturation"] },
            { id: 28, title: "Top 15 Erreurs (1-8)", duration: "8 min", tags: ["TVA", "Erreurs"] },
            { id: 29, title: "Top 15 Erreurs (9-15)", duration: "8 min", tags: ["TVA", "Erreurs"] },
            { id: 30, title: "Mini-Cas Pratiques", duration: "9 min", tags: ["TVA", "Cas"] },
            { id: 31, title: "Mentions (R√©cap Terrain)", duration: "6 min", tags: ["Facturation", "Juridique"] },
            { id: 32, title: "Acomptes (S√©curit√©)", duration: "6 min", tags: ["Facturation", "Tr√©sorerie"] },
            { id: 33, title: "Avoirs (Correction)", duration: "5 min", tags: ["Facturation", "Compta"] },
            { id: 34, title: "Relances & Impay√©s", duration: "7 min", tags: ["Gestion", "Cash"] },
            { id: 35, title: "Mise en Demeure", duration: "6 min", tags: ["Juridique", "Recouvrement"] },
            { id: 36, title: "Contrat Prestation", duration: "8 min", tags: ["Contrats", "Juridique"] },
            { id: 37, title: "10 Clauses B√©ton", duration: "9 min", tags: ["Contrats", "Juridique"] },
            { id: 38, title: "CGV (L'essentiel)", duration: "6 min", tags: ["Juridique"] },
            { id: 39, title: "Encaissement & Preuves", duration: "6 min", tags: ["Contr√¥le", "Gestion"] },
            { id: 40, title: "Banque & KYC", duration: "8 min", tags: ["Banque", "Risque"] },
            { id: 41, title: "EI R√©el : L'oubli√©e", duration: "6 min", tags: ["Statuts", "Juridique"] },
            { id: 42, title: "Micro vs R√©el : Limites", duration: "7 min", tags: ["Micro", "Strat√©gie"] },
            { id: 43, title: "SASU vs EURL : V√©rit√©", duration: "8 min", tags: ["Statuts", "Comparatif"] },
            { id: 44, title: "IS vs IR", duration: "6 min", tags: ["Fiscalit√©", "Strat√©gie"] },
            { id: 45, title: "Salaire vs Dividendes", duration: "9 min", tags: ["R√©mun√©ration", "Optimisation"] },
            { id: 46, title: "TNS vs Assimil√© Salari√©", duration: "7 min", tags: ["Statuts", "Social"] },
            { id: 47, title: "Soci√©t√© : Fausse Bonne Id√©e ?", duration: "6 min", tags: ["Statuts", "Risque"] },
            { id: 48, title: "Passer en Soci√©t√© : Timing", duration: "7 min", tags: ["Transition", "Strat√©gie"] },
            { id: 49, title: "R√©mun√©ration (3 Sc√©narios)", duration: "8 min", tags: ["R√©mun√©ration", "Cas"] },
            { id: 50, title: "Structurer √† 10k/mois", duration: "8 min", tags: ["Croissance", "Organisation"] }
        ];

        const DATA_APP = {
            accueil: {
                label: "Accueil",
                icon: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>`,
                title: "Tableau de Bord",
                desc: "Bienvenue sur l'interface gratuite FISCOR. Seuls les outils essentiels sont accessibles.",
                locked: false
            },
            formations: {
                label: "Formations",
                icon: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>`,
                title: "Centre de Formation",
                desc: "50 modules strat√©giques (Verrouill√© - Version Premium requise).",
                locked: false // Accessible to show the locked list
            },
            outils: {
                label: "Outils",
                icon: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="7" width="20" height="14" rx="2" ry="2"></rect><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path></svg>`,
                title: "Bo√Æte √† Outils",
                desc: "Utilitaires de gestion. L'outil Facture est disponible gratuitement.",
                locked: false,
                items: ["G√©n√©rateur de Facture", "G√©n√©rateur de relances", "Simulateur TNS/SASU", "Calculateur TVA", "Checklist Contr√¥le"]
            },
            templates: {
                label: "Templates",
                icon: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline></svg>`,
                title: "Mod√®les",
                desc: "",
                locked: true
            },
            cas: {
                label: "Cas Pratiques",
                icon: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path></svg>`,
                title: "√âtudes",
                desc: "",
                locked: true
            },
            ligne_rouge: {
                label: "Ligne Rouge",
                icon: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path></svg>`,
                title: "Risque",
                desc: "",
                locked: true
            },
            references: {
                label: "R√©f√©rences",
                icon: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg>`,
                title: "Refs",
                desc: "",
                locked: true
            }
        };

        const STATE = {
            currentTab: 'accueil',
            searchQuery: "",
            filterTag: null
        };

        // --- CORE FUNCTIONS ---

        function init() {
            // No auth check needed for free version, but we keep the flow
            document.getElementById('btn-login').addEventListener('click', enterApp);
            document.getElementById('btn-logout').addEventListener('click', logout);
            renderNav();
            
            // Auto Popup after 5 minutes
            setTimeout(() => {
                document.getElementById('popup-promo').classList.add('active');
            }, 300000); // 300,000ms = 5 minutes
        }
        
        function closePopup() {
            document.getElementById('popup-promo').classList.remove('active');
        }

        function enterApp() {
            document.getElementById('view-lock').classList.add('fade-out');
            setTimeout(() => { 
                document.getElementById('view-lock').classList.add('hidden'); 
                showLoadingAndApp(); 
            }, 300);
        }

        function logout() { 
            const app = document.getElementById('view-app');
            const lock = document.getElementById('view-lock');

            // Fade out app
            app.classList.remove('visible');
            
            setTimeout(() => {
                app.classList.add('hidden');
                
                // Show lock screen
                lock.classList.remove('hidden');
                // Ensure opacity is reset by removing the fade-out class
                lock.classList.remove('fade-out'); 
                
                // Reset tab state
                switchTab('accueil');
            }, 500);
        }
        
        function showLoadingAndApp() {
            const loading = document.getElementById('view-loading'); loading.classList.remove('hidden');
            setTimeout(() => { loading.classList.add('hidden'); showApp(true); }, 1500);
        }
        function showApp(animate = false) {
            const app = document.getElementById('view-app');
            app.classList.remove('hidden');
            if(animate) setTimeout(() => app.classList.add('visible'), 50); else app.classList.add('visible');
            switchTab('accueil');
        }

        // --- NAVIGATION & RENDER ---

        function renderNav() {
            const deskNav = document.getElementById('desktop-nav');
            const mobNav = document.getElementById('mobile-nav');
            deskNav.innerHTML = ''; mobNav.innerHTML = '';
            
            Object.keys(DATA_APP).forEach(key => {
                const item = DATA_APP[key];
                
                // Desktop
                const dLink = document.createElement('div');
                dLink.className = `nav-item ${key === STATE.currentTab ? 'active' : ''} ${item.locked ? 'nav-locked' : ''}`;
                dLink.innerHTML = `${item.icon} <span style="margin-left:12px;">${item.label}</span> ${item.locked ? '<svg style="margin-left:auto; width:14px; opacity:0.5;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>' : ''}`;
                if(!item.locked) dLink.onclick = () => switchTab(key);
                deskNav.appendChild(dLink);

                // Mobile
                const mLink = document.createElement('button');
                mLink.className = `b-nav-item ${key === STATE.currentTab ? 'active' : ''} ${item.locked ? 'nav-locked' : ''}`;
                mLink.innerHTML = `${item.icon}<span>${item.label}</span>`;
                if(!item.locked) mLink.onclick = () => switchTab(key);
                mobNav.appendChild(mLink);
            });
        }

        function switchTab(key) {
            if (DATA_APP[key].locked) return; // Security check

            STATE.currentTab = key;
            STATE.searchQuery = "";
            STATE.filterTag = null;
            
            renderNav(); // Re-render to update active state

            const content = document.getElementById('content-area');
            content.style.opacity = '0'; content.style.transform = 'translateY(10px)';
            setTimeout(() => {
                if (key === 'formations') renderFormationsList(container = content);
                else if (key === 'outils') renderOutils(container = content);
                else renderDashboard(container = content);
                
                content.style.transition = 'all 0.4s ease'; 
                content.style.opacity = '1'; 
                content.style.transform = 'translateY(0)';
            }, 200);
            
            // Update Title
            document.getElementById('header-title').textContent = DATA_APP[key].label.toUpperCase();
        }

        // --- CONTENT RENDERING ---

        function renderDashboard(container) {
            // NEW DASHBOARD DESIGN (Pro/Data Viz + Calendar)
            let html = `
                <div class="pro-hero fade-in">
                    <div class="pro-badge">OFFRE LIMIT√âE</div>
                    <h2 class="hero-title" style="font-size: 2rem; margin-bottom:15px;">Passez en <span style="color:var(--accent-pro)">Mode Expert</span></h2>
                    <p class="hero-desc" style="max-width:700px;">
                        Vous √™tes sur la version d√©couverte. D√©bloquez les strat√©gies avanc√©es (Holding, Expatriation), les 50 formations vid√©os et tous les simulateurs.
                    </p>
                    <div class="pro-actions">
                        <a href="https://fiscor.fr" target="_blank" class="btn-pro">D√©bloquer le Plan PRO</a>
                        <a href="https://fiscor.fr" target="_blank" class="btn-outline">Commander le Livre Physique</a>
                    </div>
                </div>
                
                <div class="cards-grid">
                    <!-- WIDGET 1: TAX MAP -->
                    <div class="card stat-card" style="border-top: 3px solid var(--accent-pro);">
                        <div class="stat-header">
                            <span class="stat-label">PRESSION FISCALE 2025</span>
                            <div class="dot purple"></div>
                        </div>
                        <h3 class="card-title">France vs Monde</h3>
                        <div style="margin-top:20px;">
                            <div class="tax-row">
                                <span class="tax-country">üá´üá∑ FR</span>
                                <div class="tax-track"><div class="tax-bar bar-red" style="--w: 95%;">60%</div></div>
                                <span class="tax-val">60%</span>
                            </div>
                            <div class="tax-row">
                                <span class="tax-country">üá™üá™ EST</span>
                                <div class="tax-track"><div class="tax-bar bar-green" style="--w: 35%;">20%</div></div>
                                <span class="tax-val">20%</span>
                            </div>
                            <div class="tax-row">
                                <span class="tax-country">üá¶üá™ UAE</span>
                                <div class="tax-track"><div class="tax-bar bar-violet" style="--w: 5%;">0%</div></div>
                                <span class="tax-val">0%</span>
                            </div>
                        </div>
                    </div>

                    <!-- WIDGET 2: MICRO RISKS -->
                    <div class="card stat-card">
                        <div class="stat-header">
                            <span class="stat-label">MICRO-ENTREPRISE 2025</span>
                            <div class="dot red"></div>
                        </div>
                        <h3 class="card-title">Zones de Danger</h3>
                        <div style="margin-top:20px;">
                            <div class="risk-item">
                                <div class="risk-head"><span>Seuil TVA</span><span style="color:var(--text-secondary);">39 100 ‚Ç¨</span></div>
                                <div class="risk-bar-bg"><div class="risk-bar-fill" style="width: 40%; background: #94A3B8;"></div></div>
                            </div>
                            <div class="risk-item">
                                <div class="risk-head"><span>Seuil CA (Svc)</span><span style="color:var(--text-secondary);">77 700 ‚Ç¨</span></div>
                                <div class="risk-bar-bg"><div class="risk-bar-fill" style="width: 70%; background: #94A3B8;"></div></div>
                            </div>
                            <div class="risk-item">
                                <div class="risk-head"><span style="color:var(--danger); font-weight:700;">AMENDES TVA</span><span>ILLIMIT√â</span></div>
                                <div class="risk-bar-bg"><div class="risk-bar-fill" style="width: 100%; background: var(--danger);"></div></div>
                            </div>
                        </div>
                    </div>

                    <!-- WIDGET 3: FISCAL CALENDAR (NEW) -->
                    <div class="card" style="grid-column: 1 / -1;">
                        <div class="stat-header">
                            <span class="stat-label">CALENDRIER FISCAL</span>
                            <div class="dot free"></div>
                        </div>
                         <div style="display:flex; flex-direction:column; gap:0;">
                            <div class="cal-item">
                                <div class="cal-date"><span>21</span>OCT</div>
                                <div class="cal-info">
                                    <div class="cal-title">D√©claration TVA (Mensuelle)</div>
                                    <div class="cal-sub">Pour CA r√©alis√© en Septembre.</div>
                                </div>
                            </div>
                            <div class="cal-item">
                                <div class="cal-date"><span>15</span>DEC</div>
                                <div class="cal-info">
                                    <div class="cal-title">Solde CFE 2024</div>
                                    <div class="cal-sub">√Ä payer sur espace Pro.</div>
                                </div>
                            </div>
                            <div class="cal-item">
                                <div class="cal-date"><span>31</span>DEC</div>
                                <div class="cal-info">
                                    <div class="cal-title">Option Lib√©ratoire</div>
                                    <div class="cal-sub">Date limite pour opter/renoncer.</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- WIDGET 4: BOOK PROMO -->
                    <div class="card book-widget" onclick="window.location.href='https://fiscor.fr'" style="cursor:pointer;">
                        <div class="book-info">
                            <div style="font-size:0.7rem; color:#aaa; margin-bottom:5px; text-transform:uppercase; letter-spacing:1px;">Le Manuel</div>
                            <h3 style="font-size:1.2rem; margin-bottom:8px; color:#fff;">La Bible Fiscale</h3>
                            <p style="font-size:0.85rem; color:#ccc; line-height:1.4;">200 pages de strat√©gies pures. L'expertise FISCOR sur votre bureau.</p>
                            <span style="display:inline-block; margin-top:15px; font-size:0.8rem; border-bottom:1px solid #fff; color:#fff;">Commander ></span>
                        </div>
                        <div class="book-visual">
                            <!-- Visual placeholder for book spine -->
                            <div style="position:absolute; top:10px; left:10px; right:10px; height:4px; background:#000;"></div>
                            <div style="position:absolute; bottom:10px; left:0; right:0; text-align:center; font-weight:800; color:#000; font-size:0.6rem; letter-spacing:1px;">FISCOR</div>
                        </div>
                    </div>

                     <!-- WIDGET 5: FREE TOOL LINK -->
                     <div class="card active-tool" onclick="window.location.href='facture.html'">
                         <div class="card-icon"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="3" y1="9" x2="21" y2="9"></line><line x1="9" y1="21" x2="9" y2="9"></line></svg></div>
                         <div class="card-title">G√©n√©rateur Facture</div>
                         <div style="font-size:0.8rem; color:var(--accent); font-weight:600;">Outil Gratuit</div>
                         <div class="card-arrow"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg></div>
                    </div>

                    <!-- WIDGET 6: TEASER COMPARATEUR (LOCKED) -->
                    <div class="card is-locked">
                        <div class="lock-icon-overlay"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg></div>
                        <div class="stat-header">
                            <span class="stat-label">SIMULATEUR REVENU</span>
                        </div>
                        <div style="display:flex; justify-content:space-around; align-items:flex-end; height:100px; padding-bottom:10px;">
                            <div style="width:30px; height:40%; background:#94A3B8; border-radius:4px 4px 0 0;"></div>
                            <div style="width:30px; height:80%; background:#7C3AED; border-radius:4px 4px 0 0;"></div>
                        </div>
                         <div class="card-title" style="text-align:center; font-size:0.9rem;">Salari√© vs Freelance</div>
                    </div>
                </div>
            `;
            container.innerHTML = html;
        }

        function renderOutils(container) {
            const data = DATA_APP['outils'];
            let html = `
                <div class="hero-section">
                    <h2 class="hero-title">${data.title}</h2>
                    <p class="hero-desc">${data.desc}</p>
                </div>
                <div class="cards-grid">
            `;
            
            data.items.forEach(item => {
                const isFree = item === "G√©n√©rateur de Facture";
                
                if (isFree) {
                    html += `
                        <div class="card active-tool" onclick="window.location.href='facture.html'">
                            <div class="card-icon"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="3" y1="9" x2="21" y2="9"></line><line x1="9" y1="21" x2="9" y2="9"></line></svg></div>
                            <div class="card-title">${item}</div>
                            <div style="font-size:0.8rem; color:var(--accent); font-weight:600;">Acc√®s Gratuit</div>
                            <div class="card-arrow"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg></div>
                        </div>
                    `;
                } else {
                    html += `
                        <div class="card is-locked">
                            <div class="lock-icon-overlay"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg></div>
                            <div class="card-icon"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"></path></svg></div>
                            <div class="card-title">${item} <span class="premium-badge">PRO</span></div>
                            <div style="font-size:0.8rem; color:var(--text-secondary);">Non disponible</div>
                        </div>
                    `;
                }
            });
            
            html += `</div>`;
            container.innerHTML = html;
        }

        function renderFormationsList(container) {
            // Extract unique tags
            const allTags = new Set();
            FORMATIONS_DB.forEach(f => f.tags.forEach(t => allTags.add(t)));

            let html = `
                <div class="hero-section">
                    <h2 class="hero-title">Centre de Formation</h2>
                    <p class="hero-desc">L'int√©gralit√© du programme FISCOR. <br><span style="color:var(--text-secondary); font-size:0.9rem;">(Contenu r√©serv√© aux membres Premium)</span></p>
                </div>
                
                <div class="search-container">
                    <input type="text" id="formation-search" class="search-input" placeholder="Rechercher dans le catalogue..." value="${STATE.searchQuery}">
                    <div style="display:flex; gap:8px; flex-wrap:wrap; align-items:center;">
                        <button class="filter-tag ${STATE.filterTag === null ? 'active' : ''}" onclick="filterFormations(null)">Tous</button>
                        ${Array.from(allTags).map(tag => `<button class="filter-tag ${STATE.filterTag === tag ? 'active' : ''}" onclick="filterFormations('${tag}')">${tag}</button>`).join('')}
                    </div>
                </div>
                
                <div class="cards-grid">
            `;

            const filtered = FORMATIONS_DB.filter(f => {
                const matchesSearch = f.title.toLowerCase().includes(STATE.searchQuery.toLowerCase());
                const matchesTag = STATE.filterTag ? f.tags.includes(STATE.filterTag) : true;
                return matchesSearch && matchesTag;
            });

            if (filtered.length === 0) {
                html += `<div style="grid-column:1/-1; text-align:center; color:var(--text-secondary); padding:40px;">Aucun module trouv√©.</div>`;
            } else {
                filtered.forEach(f => {
                    html += `
                        <div class="card is-locked">
                            <div class="lock-icon-overlay"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg></div>
                            <div>
                                <div class="f-meta">
                                    <div class="f-duration"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> ${f.duration}</div>
                                    ${f.tags.slice(0,2).map(t => `<span class="f-tag-pill">${t}</span>`).join('')}
                                </div>
                                <div class="card-title">${f.title}</div>
                            </div>
                        </div>
                    `;
                });
            }
            html += `</div>`;
            container.innerHTML = html;

            document.getElementById('formation-search').addEventListener('input', (e) => {
                STATE.searchQuery = e.target.value;
                // Simple re-render logic for this simplified version
                renderFormationsList(container); 
            });
        }

        function filterFormations(tag) {
            STATE.filterTag = tag;
            const content = document.getElementById('content-area');
            renderFormationsList(content);
        }

        window.addEventListener('DOMContentLoaded', init);

    </script>
<script type="module" src="/index.tsx"></script>
</body>
</html>